- name: Define MySQL deployment
  template:
    src: "mysql-deployment.yaml.j2"
    dest: "/root/joget/mysql-deployment.yaml"
    mode: '0755'

- name: Define Joget deployment
  template:
    src: "joget-dx8-tomcat9-deployment.yaml.j2"
    dest: "/root/joget/joget-dx8-tomcat9-deployment.yaml"
    mode: '0755'

- name: Copy run change admin password scripts
  template:
    src: "change_joget_admin_password.sh.j2"
    dest: "change_joget_admin_password.sh"
    mode: '0755'

# - name: Install joget
#   shell: |
#     cd /root/govstack/joget_backend/sandbox-demo-builder/use-cases
#     helm dependency update ./joget-full/
#     helm upgrade --install joget ./joget-full/ --create-namespace --namespace {{joget_namespace}} --values /root/govstack/joget_backend/sandbox-demo-builder/use-cases/joget-full/demo-builder-values.yaml

# - name: Wait for deployments
#   shell: bash /root/check_deployment.sh {{joget_namespace}}


# - name: Enable openimis backend
#   set_fact:
#     open_imis_backend_enabled: true

# - name: Copy chart overrides values
#   template:
#     src: "demo-builder-values.yaml.j2"
#     dest: "/root/govstack/joget_backend/sandbox-demo-builder/use-cases/joget-full/demo-builder-values.yaml"
#     mode: '0755'

# - name: Install joget with openimis backend
#   shell: |
#     cd /root/govstack/joget_backend/sandbox-demo-builder/use-cases
#     helm dependency update ./joget-full/
#     helm upgrade --install joget ./joget-full/ --create-namespace --namespace {{joget_namespace}} --values /root/govstack/joget_backend/sandbox-demo-builder/use-cases/joget-full/demo-builder-values.yaml

# - name: Wait for deployments
#   shell: bash /root/check_deployment.sh {{joget_namespace}}
